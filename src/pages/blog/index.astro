---
import BaseLayout from '../../layouts/BaseLayout.astro';
import BlogCard from '../../components/BlogCard.astro';
import { getCollection } from 'astro:content';

const posts = await getCollection('blog', ({ data }) => {
  return data.draft !== true;
});

const sortedPosts = posts.sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<BaseLayout title="Blog" description="Thoughts on film, media reviews, and various musings.">
  <div class="page-header">
    <h1>Blog</h1>
    <p>Media reviews, essays, and various thoughts</p>
  </div>

  {sortedPosts.length > 0 ? (
    <div class="posts-grid">
      {sortedPosts.map(post => (
        <BlogCard
          title={post.data.title}
          description={post.data.description}
          date={post.data.date}
          slug={post.slug}
        />
      ))}
    </div>
  ) : (
    <div class="empty-state">
      <p>No posts yet. Check back soon!</p>
    </div>
  )}
</BaseLayout>

<style>
  .posts-grid {
    display: grid;
    gap: 1.5rem;
  }

  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: var(--color-text-muted);
  }
</style>
